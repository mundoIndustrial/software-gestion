// Simular navegaci칩n a p치gina 2
$user = App\Models\User::where('name', 'yus2')->first();

$allCotizaciones = App\Models\Cotizacion::where('user_id', $user->id)
    ->where('es_borrador', false)
    ->with('tipoCotizacion', 'usuario', 'prendasCotizaciones', 'prendaCotizacion', 'logoCotizacion')
    ->orderBy('created_at', 'desc')
    ->get();

$cotPrendaCollection = $allCotizaciones->filter(fn($c) => $c->obtenerTipoCotizacion() === 'P');
$cotLogoCollection = $allCotizaciones->filter(fn($c) => $c->obtenerTipoCotizacion() === 'B');
$cotPBCollection = $allCotizaciones->filter(fn($c) => $c->obtenerTipoCotizacion() === 'PB');

$allCotizacionesCollection = $cotPrendaCollection->merge($cotLogoCollection)->merge($cotPBCollection)->sortByDesc('created_at')->values();

echo "游늵 Total de cotizaciones: {$allCotizacionesCollection->count()}\n\n";

// Paginar con p치gina 2
$perPage = 15;
$currentPage = 2;
$pageName = 'page_cot_todas';

$startIndex = ($currentPage - 1) * $perPage;
$items = $allCotizacionesCollection->slice($startIndex, $perPage)->values();

echo "游늯 P츼GINA {$currentPage}:\n";
echo "Start Index: {$startIndex}\n";
echo "Items en esta p치gina: {$items->count()}\n\n";

foreach ($items as $index => $cot) {
    echo ($startIndex + $index) . ". ID: {$cot->id} | Tipo: " . $cot->obtenerTipoCotizacion() . " | C칩digo: {$cot->numero_cotizacion} | Cliente: {$cot->cliente}\n";
}
