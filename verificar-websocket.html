<!DOCTYPE html>
<html>
<head>
    <title>Verificar WebSocket</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Verificaci√≥n de Conexi√≥n WebSocket</h1>
    
    <div id="status" class="info">Verificando...</div>
    
    <h2>Configuraci√≥n Detectada:</h2>
    <pre id="config"></pre>
    
    <h2>Prueba de Conexi√≥n:</h2>
    <pre id="test"></pre>
    
    <script>
        // Detectar configuraci√≥n de meta tags
        const config = {
            key: document.querySelector('meta[name="reverb-key"]')?.content,
            appId: document.querySelector('meta[name="reverb-app-id"]')?.content,
            host: document.querySelector('meta[name="reverb-host"]')?.content,
            port: document.querySelector('meta[name="reverb-port"]')?.content,
            scheme: document.querySelector('meta[name="reverb-scheme"]')?.content,
        };
        
        document.getElementById('config').textContent = JSON.stringify(config, null, 2);
        
        // Probar conexi√≥n WebSocket
        function testWebSocket() {
            const wsUrl = `${config.scheme === 'https' ? 'wss' : 'ws'}://${config.host}:${config.port}/app/${config.key}`;
            
            document.getElementById('test').textContent = `Intentando conectar a: ${wsUrl}`;
            
            const ws = new WebSocket(wsUrl);
            
            ws.onopen = function() {
                document.getElementById('status').innerHTML = '<div class="success">‚úÖ WebSocket conectado exitosamente</div>';
                document.getElementById('test').textContent += '\n\n‚úÖ Conexi√≥n establecida';
                ws.close();
            };
            
            ws.onerror = function(error) {
                document.getElementById('status').innerHTML = '<div class="error">‚ùå Error de conexi√≥n WebSocket</div>';
                document.getElementById('test').textContent += '\n\n‚ùå Error: ' + error;
            };
            
            ws.onclose = function() {
                document.getElementById('test').textContent += '\n\nüîå Conexi√≥n cerrada';
            };
        }
        
        if (config.key) {
            testWebSocket();
        } else {
            document.getElementById('status').innerHTML = '<div class="error">‚ùå No se detect√≥ configuraci√≥n de Reverb</div>';
            document.getElementById('test').textContent = 'Aseg√∫rate de estar en una p√°gina con meta tags de Reverb';
        }
    </script>
</body>
</html>
